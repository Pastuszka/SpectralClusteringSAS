/* Michal Pastuszka & Wojciech Bogucki (2020). Spectral Clustering for SAS */
/* spccEigenLRW: Compute eigenvectors of the unnormalized laplacian.
   Input:
   Required:
   m         a neighborhood matrix
   nvecs     number of eigenvectors to return. It is recommended to use one less
             vector than clusters searched. Note that in case of a complete 
             neighborhood matrix the first eigenvector will be constant and convey
			 no information. In that situation use one more eigenvector.
   Optional:
*/
start spccEigenL(m, nvecs);
	degree = diag(m[,+]);
	laplacian = degree - m;
	call eigen(val, rvec, laplacian);
	vectors = rvec[,(ncol(rvec)-nvecs+1):(ncol(rvec))]; 
	return vectors;
finish;